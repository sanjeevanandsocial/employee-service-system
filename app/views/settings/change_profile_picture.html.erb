<h1 class="page-title">Change Profile Picture</h1>

<% if notice %>
  <div style="background: #dcfce7; color: #166534; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #bbf7d0;">
    <%= notice %>
  </div>
<% end %>

<% if alert %>
  <div style="background: #fee2e2; color: #991b1b; padding: 12px 16px; border-radius: 8px; margin-bottom: 20px; border: 1px solid #fecaca;">
    <%= alert %>
  </div>
<% end %>

<div style="background: white; border-radius: 12px; padding: 24px; margin-bottom: 24px; border: 1px solid #e2e8f0;">
  <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 30px; align-items: start;">
    
    <!-- Current Profile Picture -->
    <div>
      <h3 style="margin: 0 0 16px 0; color: #1e293b; font-size: 18px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">Current Profile Picture</h3>
      <div style="text-align: center;">
        <% if @user.profile_picture.attached? %>
          <%= image_tag @user.profile_picture, style: "width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 3px solid #e2e8f0;" %>
        <% else %>
          <div style="width: 150px; height: 150px; background: #f8fafc; border: 2px dashed #e2e8f0; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: #64748b; font-weight: 500; font-size: 14px; margin: 0 auto; text-align: center; line-height: 1.4;">
            No current<br>profile picture
          </div>
        <% end %>
      </div>
    </div>

    <!-- Upload New Picture -->
    <div>
      <h3 style="margin: 0 0 16px 0; color: #1e293b; font-size: 18px; border-bottom: 2px solid #e2e8f0; padding-bottom: 8px;">Upload New Picture</h3>
      
      <%= form_with url: settings_update_profile_picture_path, method: :patch, multipart: true, local: true do |form| %>
        <div style="margin-bottom: 20px;">
          <label style="display: block; font-weight: 600; color: #64748b; margin-bottom: 8px; font-size: 12px;">Select Image</label>
          <%= form.file_field :profile_picture, accept: "image/*", id: "profile_picture_input", style: "width: 100%; padding: 10px; border: 1px solid #e2e8f0; border-radius: 8px; font-size: 14px;" %>
        </div>
        
        <div style="margin-bottom: 20px; text-align: center;">
          <img id="image_preview" style="width: 150px; height: 150px; border-radius: 50%; object-fit: cover; border: 3px solid #e2e8f0; display: none;" />
        </div>
        
        <div style="text-align: center;">
          <%= form.submit "Update Profile Picture", class: "add-btn" %>
        </div>
      <% end %>
      
      <script>
        document.getElementById('profile_picture_input').addEventListener('change', function(event) {
          const file = event.target.files[0];
          const preview = document.getElementById('image_preview');
          
          if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
              preview.src = e.target.result;
              preview.style.display = 'block';
            };
            reader.readAsDataURL(file);
          } else {
            preview.style.display = 'none';
          }
        });
      </script>
    </div>
    
  </div>
</div>