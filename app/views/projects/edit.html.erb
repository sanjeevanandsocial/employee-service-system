<div class="form-container" style="max-width: 600px;">
  <div style="text-align: right; margin-bottom: 15px;">
    <%= link_to "Back", projects_path, class: "btn-secondary" %>
  </div>

  <div class="form-card">
    <div class="tab-container">
      <div class="tab-buttons">
        <button type="button" class="tab-btn active" onclick="switchTab('status')">Update Status</button>
        <button type="button" class="tab-btn" onclick="switchTab('details')">Update Details</button>
      </div>
    </div>

    <!-- Status Update Form -->
    <div id="status-tab" class="tab-content active">
      <div class="form-header">
        <h1 class="form-title">Update Project Status</h1>
      </div>
      
      <div class="project-info">
        <div class="project-title" style="padding: 10px 0;font-size: 20px;">
          <i class="fas fa-project-diagram"></i> <%= @project.title %>
        </div>
        <div class="current-status" style="margin-bottom: 4px;">
          <span>Project ID:</span>
          <span style="font-weight: 600; color: #1e293b;"><%= @project.id %></span>
        </div>
        <div class="current-status" style="margin-top: 0;">
          <span>Current Status:</span>
          <% 
            status_class = case @project.status
                          when "planned" then "status-planned"
                          when "in_progress" then "status-in-progress"
                          when "on_hold" then "status-on-hold"
                          when "completed" then "status-completed"
                          end
          %>
          <span class="status-badge <%= status_class %>">
            <%= @project.status.gsub('_', ' ').titleize %>
          </span>
        </div>
      </div>
      
      <%= form_with model: @project, url: project_path(@project), method: :patch, local: true do |f| %>
        <div class="form-group">
          <%= f.label :status, "Change Status To:", class: "form-label" %>
          <% 
            status_options = case @project.status
                            when "planned"
                              [["In Progress", "in_progress"], ["Cancelled", "cancelled"]]
                            when "in_progress"
                              [["On Hold", "on_hold"], ["Completed", "completed"], ["Cancelled", "cancelled"]]
                            when "on_hold"
                              [["In Progress", "in_progress"], ["Cancelled", "cancelled"]]
                            else
                              []
                            end
          %>
          
          <% if status_options.any? %>
            <%= f.select :status, status_options, { prompt: "Select new status" }, { class: "form-select" } %>
          <% else %>
            <div class="no-options">
              <i class="fas fa-info-circle"></i>
              No status changes available for current Project.
            </div>
          <% end %>
        </div>
        
        <div class="btn-group">
          <% if status_options.any? %>
            <%= f.submit "Update Status", class: "btn-primary" %>
          <% end %>
        </div>
      <% end %>
    </div>

    <!-- Details Update Form -->
    <div id="details-tab" class="tab-content">
      <div class="form-header">
        <h1 class="form-title">Update Project Details</h1>
      </div>
      
      <%= form_with model: @project, url: project_path(@project), method: :patch, local: true do |f| %>
        <div class="form-group">
          <%= f.label :id, "Project ID", class: "form-label" %>
          <%= f.number_field :id, class: "form-select form-select", disabled: true %>
        </div>

        <div class="form-group">
          <%= f.label :title, "Project Name", class: "form-label" %>
          <%= f.text_field :title, class: "form-select", placeholder: "Enter project name" %>
        </div>

        <div class="form-group">
          <%= f.label :description, class: "form-label" %>
          <%= f.text_area :description, rows: 4, class: "form-select", placeholder: "Enter project description" %>
        </div>
        
        <div class="btn-group">
          <%= f.submit "Update Details", class: "btn-primary" %>
        </div>
      <% end %>
    </div>
  </div>
</div>

<script>
  function switchTab(tab) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(content => {
      content.classList.remove('active');
    });
    document.querySelectorAll('.tab-btn').forEach(btn => {
      btn.classList.remove('active');
    });
    
    // Show selected tab
    document.getElementById(tab + '-tab').classList.add('active');
    event.target.classList.add('active');
  }
</script>
